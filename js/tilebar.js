import sf from"./helpers/small_functions";import{zoom}from"./helpers/zoom";import gui from"./gui";export default class tilebar extends gui{constructor(e,t,i,n,o,s){super(),this.bmsObj=e,this.tachoObj=t,this.captureModeMgr=i,this.dataLoggingMgr=n,this.colorModeObj=o,this.rearrangeManager=s,sf.isChrome()||(this.table.classList.add("hidden"),this.nothingConnectedOverlay.classList.add("hidden"),this.tilebarDOM.classList.add("disabled"),alert("This site is tailored around Progressive Wep App services that are only supported in full by Chrome.\nPlease open this site in Chrome only as we can't ensure functionality otherwise ;)"))}addEventListeners(){document.getElementById("tileBarConnectBMS").addEventListener("click",()=>{this.bmsObj.connect()}),document.getElementById("tileBarConnectTacho").addEventListener("click",()=>{this.tachoObj.connect()}),document.getElementById("tileBarDisconnect").addEventListener("click",()=>{this.resetAutoconnectBMSSilentInstant(),this.resetAutoconnectTachoSilentInstant(),this.bmsObj.disconnect(!0).then(()=>{this.tachoObj.disconnect()})}),document.getElementById("tileBarBoardInfo").addEventListener("click",()=>{this.captureModeMgr.closeCaptureMode(),this.hideAllSettings(),this.boardInfoContainer.classList.contains("hidden")?this.bmsObj.isConnected()&&(this.boardInfoContainer.classList.remove("hidden"),sf.zoomedIn()?zoom.out({callback:()=>{sf.scrollToElement(this.boardInfoContainer)}}):sf.scrollToElement(this.boardInfoContainer)):sf.scrollToElement(this.table)}),document.getElementById("tileBarBoardConfig").addEventListener("click",()=>{this.captureModeMgr.closeCaptureMode(),this.hideAllSettings(),this.boardConfigContainer.classList.contains("hidden")?this.bmsObj.isConnected()&&(this.boardConfigContainer.classList.remove("hidden"),sf.zoomedIn()?zoom.out({callback:()=>{sf.scrollToElement(this.boardConfigContainer)}}):sf.scrollToElement(this.boardConfigContainer)):sf.scrollToElement(this.table)}),document.getElementById("tileBarBoardCalib").addEventListener("click",()=>{this.captureModeMgr.closeCaptureMode(),this.hideAllSettings(),this.boardCalibContainer.classList.contains("hidden")?this.bmsObj.isConnected()&&(sf.zoomedIn()?zoom.out({callback:()=>{this.boardCalibContainer.classList.remove("hidden"),sf.scrollToElement(this.boardCalibContainer)}}):(this.boardCalibContainer.classList.remove("hidden"),sf.scrollToElement(this.boardCalibContainer))):sf.scrollToElement(this.table)}),document.getElementById("tileBarTachoConfig").addEventListener("click",()=>{this.captureModeMgr.closeCaptureMode(),this.hideAllSettings(),this.inlineConfigContainer.classList.contains("hidden")?this.tachoObj.isConnected()&&(this.inlineConfigContainer.classList.remove("hidden"),sf.zoomedIn()?zoom.out({callback:()=>{sf.scrollToElement(this.inlineConfigContainer)}}):sf.scrollToElement(this.inlineConfigContainer)):sf.scrollToElement(this.table)}),document.getElementById("tileBarSelectDataLoggingFile").addEventListener("click",()=>{this.bmsObj.isConnected()&&this.tachoObj.isConnected()||this.dataLoggingMgr.dataLoggingEnabled||this.dataLoggingMgr.newFile().then()}),document.getElementById("tileBarStartDataLogging").addEventListener("click",()=>{!this.bmsObj.isConnected()&&this.tachoObj.isConnected()||(void 0===this.dataLoggingMgr.loggingFileObj||null===this.dataLoggingMgr.loggingFileObj?this.dataLoggingMgr.newFile().then(()=>{this.dataLoggingMgr.dataLoggingEnabled=!0,document.getElementById("logging-span").classList.add("recording")}):(this.dataLoggingMgr.dataLoggingEnabled=!0,document.getElementById("logging-span").classList.add("recording")))}),document.getElementById("tileBarStopDataLogging").addEventListener("click",()=>{this.dataLoggingMgr.dataLoggingEnabled&&(document.getElementById("logging-span").classList.remove("recording"),this.dataLoggingMgr.closeFile())}),document.getElementById("tileBarAbout").addEventListener("click",()=>{this.captureModeMgr.closeCaptureMode(),this.hideAllSettings(),this.interfaceSettingsContainer.classList.contains("hidden")?(this.disableNothingConnectedOverlay(),sf.zoomedIn()?zoom.out({callback:()=>{this.interfaceSettingsContainer.classList.remove("hidden"),this.interfaceSettingsContainer.scrollIntoView({behavior:"smooth"})}}):(this.interfaceSettingsContainer.classList.remove("hidden"),sf.scrollToElement(this.interfaceSettingsContainer))):(this.bmsObj.isDisconnected()&&!this.tachoObj.isConnected()&&this.enableNothingConnectedOverlay(),this.table.scrollIntoView({behavior:"smooth"}),this.interfaceSettingsContainer.classList.add("hidden"))}),document.getElementById("tileBarDarkmode").addEventListener("click",()=>{this.colorModeObj.toggle()}),this.tileBarEditMode.addEventListener("click",()=>{this.rearrangeManager.toggleTileMoveMode()}),"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices?this.tileBarCaptureMode.addEventListener("click",()=>{this.hideAllSettings(),this.captureModeContainer.classList.contains("display-none")?sf.zoomedIn()?zoom.out({callback:()=>{this.captureModeMgr.activateCaptureMode(),this.captureModeContainer.scrollIntoView({behavior:"smooth"})}}):(this.captureModeMgr.activateCaptureMode(),this.captureModeContainer.scrollIntoView({behavior:"smooth"})):(this.captureModeMgr.closeCaptureMode(),this.table.scrollIntoView({behavior:"smooth"}))}):this.tileBarCaptureMode.classList.add("display-none")}scrollToBoardInfo(){this.hideAllSettings(),this.boardInfoContainer.classList.remove("hidden"),sf.zoomedIn()?zoom.out({callback:()=>{sf.scrollToElement(this.boardInfoContainer)}}):sf.scrollToElement(this.boardInfoContainer)}}